<!-- start sidenav -->
<div class="reporting-sidenav">
  <p-sidebar [(visible)]="_displaySidebar" dir="rtl" [style]="{width:'35em'}" position="right"
    expandIcon="pi pi-fw pi-chevron-right">
    <div class="sidebar-container">
      <div class="bootstrap-accordion">
        <div class="row">
          <!-- expansion #1 -->
          <div class="col-12">
            <!-- start report settings global 1 -->
            <div class="report-accordion-settings mt-5 mb-3">
              <a class="collabse-btn d-flex justify-content-between align-items-center" data-toggle="collapse"
                href="#globalSettings" role="button" aria-expanded="false" aria-controls="collapseExample">
                تخطيط التقرير

                <span>
                  <i class="fa-solid fa-chevron-down"></i>
                </span>
              </a>
              <!-- content collapse 1-->
              <div class="collapse" id="globalSettings">
                <div class="collapse-content px-3">
                  <div class="row">
                    <!-- header padding -->
                    <div class="col-6">
                      <div class="form-group mt-3 mb-2">
                        <input type="range" class="form-control-range" id="paddingHeaderChanger"
                          [(ngModel)]="cardHeader.padding" min="1" max="100" step="1">
                        <label for="paddingHeaderChanger">حواف العنوان</label>
                      </div>
                    </div>
                    <!-- content padding -->
                    <div class="col-6">
                      <div class="form-group mt-3 mb-2">
                        <input type="range" class="form-control-range" id="paddingContentChanger"
                          [(ngModel)]="cardContent.padding" min="5" max="100" step="1">
                        <label for="paddingContentChanger">حواف المحتوى</label>
                      </div>
                    </div>
                    <!-- header padding -->
                    <div class="col-6">
                      <div class="form-group mt-3 mb-1">
                        <input type="range" class="form-control-range" id="paddingFooterChanger"
                          [(ngModel)]="cardFooter.padding" min="1" max="100" step="1">
                        <label for="paddingFooterChanger">حواف النهايه</label>
                      </div>
                    </div>
                    <div class="col-6">
                      <!-- border radius -->
                      <div class="form-group mt-3 mb-1">
                        <input type="range" class="form-control-range" id="borderRadiusChanger"
                          [(ngModel)]="border.radius" min="1" max="50" step="1">
                        <label for="borderRadiusChanger">منحنى الحدود</label>
                      </div>
                    </div>
                    <!-- border color -->
                    <div class="col-6">
                      <div class="form-group text-right" style="margin-top: 25px;">
                        <input type="color" id="borderColorChanger" [(ngModel)]="border.color" style="height: 50px;">
                        <label for="borderColorChanger">لون الحدود</label>
                      </div>
                    </div>
                    <!-- border width -->
                    <div class="col-6">
                      <div class="borderWidth-columns-select mb-3">
                        <label for="borderWidthChanger" class="text-right w-100"> حجم الحدود</label>
                        <p-dropdown id="borderWidthChanger" [options]="borderSizeOptions"
                          [(ngModel)]="border.size"></p-dropdown>
                      </div>
                    </div>
                    <!-- enable change diminsion -->
                    <div class="col-12">
                      <div class="enable-change text-right d-flex align-items-center py-1 mb-2">
                        <p-inputSwitch [(ngModel)]="enableChangeDiminsion"></p-inputSwitch>
                        <label class="mx-2">تفعيل التعديل على الابعاد</label>
                      </div>
                    </div>
                    <!-- header height -->
                    <div class="col-6">
                      <div class="form-group text-right">
                        <input type="number" id="headerHeightChanger" min="80" [(ngModel)]="cardHeader.height" [disabled]="!enableChangeDiminsion">
                        <label for="headerHeightChanger">طول العنوان</label>
                      </div>
                    </div>
                    <!-- content height -->
                    <div class="col-6">
                      <div class="form-group text-right">
                        <input type="number" id="contentHeightChanger" min="80" [(ngModel)]="cardContent.height" [disabled]="!enableChangeDiminsion">
                        <label for="contentHeightChanger">طول المحتوى</label>
                      </div>
                    </div>
                    <!-- content height -->
                    <div class="col-6">
                      <div class="form-group text-right">
                        <input type="number" id="footerHeightChanger" min="80" [(ngModel)]="cardFooter.height" [disabled]="!enableChangeDiminsion">
                        <label for="footerHeightChanger">طول النهايه</label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- expansion #2 -->
          <div class="col-12">
            <div class="report-accordion-add-tools">
              <a class="collabse-btn d-flex justify-content-between align-items-center" data-toggle="collapse"
                href="#addTools" role="button" aria-expanded="false" aria-controls="collapseExample">
                اضافه ادوات
                <span>
                  <i class="fa-solid fa-chevron-down"></i>
                </span>
              </a>
              <!-- content collapse 1-->
              <div class="collapse" id="addTools">
                <div class="collapse-content px-3">
                  <div class="row">
                    <div class="col-12">
                      <div class="report-tools p-2 text-right">
                        <span class="add-text-box mx-2" (click)="showAddTextDialog()">
                          اضافه نص
                          <i class="fa-solid fa-plus mr-2"></i>
                        </span>

                        <span class="add-text-box mx-2" (click)="showDialogAddImage()">
                          اضافه صورة
                          <i class="fa-solid fa-plus mr-2"></i>
                        </span>

                        <span class="add-text-box mx-2" (click)="createTable()">
                          اضافه جدول
                          <i class="fa-solid fa-plus mr-2"></i>
                        </span>
                        <span class="add-text-box mx-2" (click)="showAddChartDialog()">
                          اضافه رسم بيان
                          <i class="fa-solid fa-plus mr-2"></i>
                        </span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

            </div>
          </div>
          <!-- generate table settings -->
          <div class="table-settings col-12 w-100">
            <div class="row">

              <div class="col-12" *ngFor="let template of headerTemplate; let i = index">
                <div *ngTemplateOutlet="headerTemplate[i]" class="w-100">

                </div>
              </div>
            </div>
          </div>
          <!-- expansion #3 -->
          <div class="col-12">
            <hr>
            <div class="report-printing">
              <div class="row">
                <div class="col-12">
                  <div class="printing-container">
                    <div class="row">
                      <div class="col-12 text-right pt-3 pb-2">
                        <p class="my-2 px-2">استخراج التقرير</p>
                        <button class="btn btn-info  btn-sm" (click)="makePdf()">Export PDF</button>
                      </div>
                      <div class="col-12 text-right">
                        <p class="my-2 px-2">اعدادات طباعه التقرير</p>
                        <div class="row">
                          <!-- page type -->
                          <div class="col-6">
                            <!-- table header font size -->
                            <div class="form-group">
                              <input type="number" class="form-control-range" id="pageZoomChanger"
                                [(ngModel)]="printSettings.zoom" min="0" max="100" step="1">
                              <label for="pageZoomChanger"> بعد الصفحه </label>
                            </div>
                          </div>
                          <!-- layout selector -->
                          <div class="col-12">
                            <div class="layout-group d-flex mb-3">
                              <div class="form-check">
                                <input class="form-check-input" type="radio" name="exampleRadios" id="portrait"
                                  value="notScapped" checked [(ngModel)]="printSettings.layout">
                                <label class="form-check-label mr-3" for="portrait">
                                  طول الصفحه
                                </label>
                              </div>
                              <div class="form-check">
                                <input class="form-check-input" type="radio" name="exampleRadios" id="landscape"
                                  value="landscape" [(ngModel)]="printSettings.layout">
                                <label class="form-check-label mr-3" for="landscape">
                                  عرض الصفحه
                                </label>
                              </div>
                            </div>
                          </div>
                          <!-- print button -->
                          <div class="col-12">
                            <div class="print-action py-3">
                              <button class="btn btn-secondary btn-sm" (click)="onPrint1(contentReport)">طباعه التقرير</button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </p-sidebar>
</div>


<!-- sidenav expanding icon -->
<button class="toggle-reporting-drawer mt-1" (click)="displaySidebar()" color="light" title="تعديل الريبور">
  <i class="fa-solid fa-gear"></i>
</button>

<div id="print-section position-relative test" #content ngxPrintElement>
  <div id="pageFooter"></div>


  <!-- start sidenav -->
  <div class="reporting-container">

    <!-- content of sidenav -- body container -->
    <div class="sidenav-container w-100">
      <!-- report content -->
      <!-- report container -->
      <div class="container-fluid report-container p-3 w-100">

        <div class="printable" #exportPdf>

          <!-- <div id="header">Top div content</div>

        <div id="footer">Bottom div content</div> -->
          <!-- report card -->
          <div class="card w-100" style="border: none !important;"
            style="font-family: Balsamiq-Sans, serif; letter-spacing: 0.01px;">
            <!-- card header -->
            <div class="card-header-report my-parent card-header w-100" #cardHeaderReport [style.padding]="cardHeader.padding+'px'"
              [style.borderRadius]="border.radius+'px'" [style.borderColor]="border.color"
              [style.borderWidth]="border.size+'px'" [style.height]="enableChangeDiminsion ? cardHeader.height + 'px' : 'auto'" >
              <div class="div-header-container d-flex align-items-center justify-content-start w-100 ui-rtl px-3 py-2"
                dir="rtl">
                <!-- default header reporting name -->
                <div class="title-right d-flex justify-content-center align-center flex-column" dir="ltr">
                  <!-- egypt icon -->
                  <div class="icon-egypt text-center position-relative">
                    <app-image [imageSrc]="'/assets/150px-Coat_of_arms_of_Egypt_(on_flag).svg.png'"
                      [imageWidth]="30"></app-image>
                  </div>
                  <app-text-area>
                    <div contenteditable="true" #textArea class="text-editable">
                      <h4 class="mb-0" style="font-size: 12px; text-align: center;">جمهوريه مصر العربيه</h4>
                      <h4 class="mb-0" style="font-size: 12px; text-align: center;">وزارة التخطيط والتنميه الاقتصاديه
                      </h4>
                    </div>
                  </app-text-area>
                </div>
              </div>
              <div #componentHeader>

              </div>
            </div>
            <div class="card-content-report card-body w-100 my-2 overflow-hidden" #cardContentReport [style.padding]="cardContent.padding+'px'"
              [style.borderRadius]="border.radius+'px'" [style.borderColor]="border.color"
              [style.borderWidth]="border.size+'px'" [style.height]="enableChangeDiminsion ? cardContent.height + 'px' : 'auto'">
              <div class="headers-container-top">
                <div class="row">
                  <!-- main report title -->
                  <div class="col-12">
                    <div class="report-main-title d-flex justify-content-center align-items-center">
                      <app-text-area>
                        <div #textArea contenteditable="true" class="text-editable">
                          <h2 class="mb-0" style="text-decoration: underline; text-align: center;">انجازات وزارة التخطيط
                            والتنميه
                            الاقتصاديه</h2>
                          <h2 class="mb-0" style="text-decoration: underline; text-align: center;">من مشروعات وبرامج
                            خلال
                            الفترة
                            من 2018 الى 2024</h2>
                        </div>
                      </app-text-area>
                    </div>
                  </div>
                  <!-- details report table -->
                  <div class="col-12">
                    <div class="d-flex justify-content-center align-items-center">
                      <div class="details-table mt-2" #detailsTable
                        cdkDragBoundary=".card-content-report , .card-header-report" cdkDrag>
                        <div class="movement-line" cdkDragHandle></div>
                        <span class="mx-1 left-move-icon" cdkDragHandle>
                          <i class="fa-solid fa-up-down-left-right"></i>
                        </span>
                        <div class="d-flex align-items-center parentNodeText">
                          <!-- reporting settings -->
                          <div class="icon-container">
                            <div class="d-flex align-items-center">
                              <!-- delete element icon -->
                              <span class="mx-1 element-remove-icon"
                                (click)="confirmationDeleteDetailsTable(detailsTable)">
                                <i class="fa-solid fa-xmark"></i>
                              </span>
                              <!-- edit element icon -->
                              <span class="mx-1 element-move-icon" cdkDragHandle>
                                <i class="fa-solid fa-up-down-left-right"></i>
                              </span>
                            </div>
                          </div>
                          <!-- element content text -->

                          <div class="details-report-table d-flex justify-content-end">
                            <table class="table-bordered table-hover" dir="rtl"
                              style="direction: rtl; text-align: right;">
                              <thead>
                                <tr>
                                  <th class="text-center mb-0">اسم المؤسسه</th>
                                  <th> الجهه التابع لها </th>
                                  <th> تاريخ اعتماد التقرير </th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr>
                                  <td>مؤسسه حكوميه</td>
                                  <td> مؤسسه حكوميه </td>
                                  <td> {{dateNow|date}} </td>
                                </tr>
                              </tbody>
                            </table>
                          </div>

                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-12">
                    <div class="descriptions d-flex justify-content-between align-items-center px-3 mt-3">
                      <div class="description-1">
                        <app-text-area>
                          <div #textArea contenteditable="true" class="text-editable text-center" style="width: 350px;">
                            اختبار الكلام يصير مواقف اتصالية من الطلاب. هذه الكتابة <br>
                            ستبرز عن اختبارت اللغة العربية خاصة مهارة <br>
                            الكلام.
                            المقابلة هي نوع منها التي يستدعها الدا
                          </div>
                        </app-text-area>
                      </div>
                      <div class="description-2">
                        <app-text-area>
                          <div #textArea contenteditable="true" class="text-editable text-center" style="width: 350px;">
                            اختبار الكلام يصير مواقف اتصالية من الطلاب. هذه الكتابة <br>
                            ستبرز عن اختبارت اللغة العربية خاصة مهارة <br>
                            الكلام.
                            المقابلة هي نوع منها التي يستدعها الدا
                          </div>
                        </app-text-area>
                      </div>
                      <div class="description-3">
                        <app-text-area>
                          <div #textArea contenteditable="true" class="text-editable text-center" style="width: 350px;">
                            اختبار الكلام يصير مواقف اتصالية من الطلاب. هذه الكتابة <br>
                            ستبرز عن اختبارت اللغة العربية خاصة مهارة <br>
                            الكلام.
                            المقابلة هي نوع منها التي يستدعها الدا
                          </div>
                        </app-text-area>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div #componentContainer>

              </div>
              <app-table [reports]="reports" [cols]="cols"></app-table>
            </div>
            <div class="card-footer-report card-footer w-100 m-0 d-flex align-items-center" #cardFooterReport [style.padding]="cardFooter.padding+'px'"
              [style.borderRadius]="border.radius+'px'" [style.borderColor]="border.color"
              [style.borderWidth]="border.size+'px'" [style.height]="enableChangeDiminsion ? cardFooter.height + 'px' : 'auto'" dir="rtl">
              <div class="div-footer-container d-flex align-items-center justify-content-between w-100 h-100 ui-rtl"
                dir="rtl">
                <div class="print-date">
                  تاريخ الطباعه: <span>{{dateNow}}</span>
                </div>
                <div #componentFooter>

                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>


</div>


<!-- confirm dialog (primeng) -->
<p-confirmDialog #cd dir="rtl" header="تاكيد الحذف" [transitionOptions]="'150ms'">
  <p-footer>
    <button type="button" class="btn btn-success btn-sm" (click)="cd.accept()">نعم</button>
    <button type="button" class="btn btn-danger btn-sm" (click)="cd.reject()">تجاهل</button>
  </p-footer>
</p-confirmDialog>



<!-- add image dialog -->
<p-dialog [(visible)]="displayDialogAddImage"  closeIcon="" [style]="{width: '600px' , zIndex:999999999999999999999}"
  (onHide)="dialogAddImageHide()">
  <p-header closeIcon="">
    اختر الصورة
  </p-header>
  <div class="dialog-content">
    <div class="row">
      <div class="col-8">
        <p class="par-describtion-way" style="width: 350px;">يجب اختيار المكان الذى سيوضع بيه الصورة ويمكنك التعديل
          على كل خصائص الصورة الان وحتى بعد الانشاء</p>
      </div>
      <div class="col-4">
        <div class="borderWidth-columns-select mb-3">
          <label for="borderWidthChanger" class="text-right w-100">اختر مكان النص</label>
          <p-dropdown id="borderWidthChanger" [options]="postionOptions" [(ngModel)]="postionSelected"></p-dropdown>
        </div>
      </div>
      <div class="col-12">
        <div class="upload-image">
          <input type="file" #selectedImageInput class="input-upload d-none" id="uploadImage"
            (change)="selectedImage($event)">
          <label class="input-upload-image-label" for="uploadImage">
            اختر صورة من هنا
            <span>
              <i class="fa-solid fa-cloud-arrow-up" style="color: #a2bed7;"></i>
            </span>
          </label>
        </div>
      </div>
      <div class="col-12">
        <div class="preiview-container">
          <img [src]="imageSrc" class="preiview-image" #priview alt="preview image" width="160px" height="120px">
        </div>
      </div>
    </div>
  </div>
  <p-footer>
    <button type="button" class="btn btn-success btn-sm" (click)="createImage()">نعم</button>
    <button type="button" class="btn btn-danger btn-sm" (click)="closeImageDialog()">تجاهل</button>
  </p-footer>
</p-dialog>


<!-- add new charts dialog -->
<p-dialog [(visible)]="displayDialogAddCharts" closeIcon="" [style]="{width: '600px' , zIndex:999999999999999999999}">
  <p-header>
    اضافه رسم ريانات
  </p-header>
  <!-- dialog content have shape of charts to select one from it -->
  <div class="dialog-content">
    <div class="charts-container-dialog text-right">
      <a class="chart-selector mx-2" title="doughnut" (click)="selectedCharts('doughnut')"
        [class.activeChart]="isActiveChart == 'doughnut'">
        <img src="../../../../../assets/pie-chart.png" style="width: 100%;">
      </a>
      <a class="chart-selector mx-2" title="bar" (click)="selectedCharts('bar')"
        [class.activeChart]="isActiveChart == 'bar'">
        <img src="../../../../../assets/bar-chart2.png" style="width: 100%;">
      </a>
    </div>
    <!-- chart is doughnut settings -->
    <div class="charts-settings text-right" *ngIf="isActiveChart == 'doughnut'">
      <div class="row">
        <div class="col-12">
          <!-- description settings -->
          <p class="par-describtion-way">سيتم عرض البينات طبقا لعامود معين وسيتم تقسيم البيانات على حسب هذا العامود من
            حيث العدد ويمكنك ايضا ان تطبق بعض العمليات</p>
          <div class="row">
            <div class="col-7">
              <!-- column to handle chart by it -->
              <div class="filter-columns-select">
                <label for="chartColumn" class="text-right w-100"> يتم رسم البيانات طبقا لعامود معين </label>
                <p-dropdown id="chartColumn" appendTo="body" [options]="columnsOperations"
                  [(ngModel)]="selectedLabelChartColumn"></p-dropdown>
              </div>
            </div>
            <div class="col-5">
              <!-- operation to perform on chart by another column -->
              <div class="filter-columns-select">
                <label for="chartColumn" class="text-right w-100">هل تريد عمليه معينه</label>
                <p-dropdown id="chartColumn" appendTo="body" [options]="operations"
                  [(ngModel)]="selectedOperationChartColumn"></p-dropdown>
              </div>
            </div>
          </div>
        </div>
        <div class="col-7" *ngIf="selectedOperationChartColumn != null && selectedOperationChartColumn != 2">
          <!-- column will be displayed based on operation -->
          <div class="filter-columns-select my-2">
            <label for="chartColumn" class="text-right w-100"> اختر العامود المطلوب للعمليه </label>
            <p-dropdown id="chartColumn" appendTo="body" [options]="columnsOperationsNumbers"
              [(ngModel)]="selectedLabelChartColumnForOperation"></p-dropdown>
          </div>
        </div>
      </div>
    </div>
    <!-- chart is bar settings -->
    <div class="charts-settings text-right" *ngIf="isActiveChart == 'bar'">
      <div class="row">
        <!-- way of displaying -->
        <div class="col-7">
          <div class="filter-columns-select">
            <label for="chartColumn" class="text-right w-100">اختر طريقه يتم عرض الرسم بها</label>
            <p-dropdown id="chartColumn" appendTo="body" [options]="barChartsDisplayWayOptions"
              [(ngModel)]="barChartsDisplayWay"></p-dropdown>
          </div>
        </div>
        <!-- way 1 -->
        <div class="col-12" *ngIf="barChartsDisplayWay == 0">
          <!-- description settings -->
          <p class="par-describtion-way">سيتم عرض البينات طبقا لعامود معين وسيتم تقسيم البيانات على حسب هذا العامود من
            حيث العدد ويمكنك ايضا ان تطبق بعض العمليات</p>
          <div class="row">
            <div class="col-7">
              <!-- column to handle chart by it -->
              <div class="filter-columns-select">
                <label for="chartColumn" class="text-right w-100"> يتم رسم البيانات طبقا لعامود معين </label>
                <p-dropdown id="chartColumn" appendTo="body" [options]="columnsOperations"
                  [(ngModel)]="selectedLabelChartColumn"></p-dropdown>
              </div>
            </div>
            <div class="col-5">
              <!-- operation to perform on chart by another column -->

              <div class="filter-columns-select">
                <label for="chartColumn" class="text-right w-100">هل تريد عمليه معينه</label>
                <p-dropdown id="chartColumn" appendTo="body" [options]="operations"
                  [(ngModel)]="selectedOperationChartColumn"></p-dropdown>
              </div>
            </div>
            <div class="col-12" *ngIf="selectedOperationChartColumn != null && selectedOperationChartColumn != 2">
              <!-- description settings -->

              <p class="par-describtion-way">سيتم تطبيق العمليه على العامود المختار بحيث يصنف البيانات على حسب العامود
                الاول ويعرضها طبقا للعمليه</p>
              <div class="row">
                <div class="col-7">
                  <!-- column will be displayed based on operation -->
                  <div class="filter-columns-select my-1">
                    <label for="chartColumn" class="text-right w-100"> اختر العامود المطلوب للعمليه </label>
                    <p-dropdown id="chartColumn" appendTo="body" [options]="columnsOperationsNumbers"
                      [(ngModel)]="selectedLabelChartColumnForOperation"></p-dropdown>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- way 2 -->
        <div class="col-12" *ngIf="barChartsDisplayWay == 1">

        </div>
      </div>
    </div>
  </div>
  <p-footer>
    <button type="button" class="btn btn-success btn-sm" (click)="createChart()">اضافه</button>
    <button type="button" class="btn btn-danger btn-sm" (click)="closeChartDialog()">تجاهل</button>
  </p-footer>
</p-dialog>

<!-- end sidenav -->

<!-- text box dialog -->
<p-dialog [(visible)]="displayDialogAddText" closeIcon="" [style]="{width: '700px' , zIndex:999999999999999999999}"
  class="dialog-textbox">
  <p-header>
    اضافه نص
  </p-header>
  <div class="dialog-content overflow-hidden">
    <div class="row">
      <div class="col-12">
        <div class="row">
          <div class="col-8">
            <p class="par-describtion-way" style="width: 350px;">يجب اختيار المكان الذى سيوضع بيه النص ويمكنك التعديل
              على كل خصائص النص الان وحتى بعد الانشاء</p>
          </div>
          <div class="col-4">
            <div class="borderWidth-columns-select mb-3">
              <label for="borderWidthChanger" class="text-right w-100">اختر مكان النص</label>
              <p-dropdown id="borderWidthChanger" [options]="postionOptions" [(ngModel)]="postionSelected"></p-dropdown>
            </div>
          </div>
        </div>
      </div>
      <div class="col-12">
        <div class="editor-container p-2">
          <angular-editor [placeholder]="'اكتب هنا ماتريد...'" [(ngModel)]="value"
            [config]="editorConfig"></angular-editor>
        </div>
      </div>
    </div>
  </div>
  <p-footer>
    <button type="button" class="btn btn-success btn-sm" (click)="createTextBox()">نعم</button>
    <button type="button" class="btn btn-danger btn-sm" (click)="closeTextBoxDialog()">تجاهل</button>
  </p-footer>
</p-dialog>


